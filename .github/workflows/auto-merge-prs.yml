name: Auto-Merge PRs

on:
  pull_request:
      types: [opened, synchronize, reopened]

      jobs:
        approve-and-merge:
            if: github.event.pull_request.draft == false
                runs-on: ubuntu-latest
                    steps:
                          - uses: actions/checkout@v4

                                - name: Approve & Merge
                                        if: github.event.pull_request.merged == false
                                                uses: tj-actions/approve-and-merge@v1
                                                        with:
                                                                  github-token: ${{ secrets.GITHUB_TOKEN }}
                                                                            merge-method: squash
                                                                                      auto-merge: true
                                                                                                delete-branch-on-merge: true

                                                                                                      - name: "Dad Joke Commit"
                                                                                                              if: success()
                                                                                                                      run: |
                                                                                                                                JOKES=(
                                                                                                                                            "Why did the frontend break up with the backend? Too many GET requests."
                                                                                                                                                        "Why do programmers hate nature? Too many bugs."
                                                                                                                                                                    "A SQL query walks into a bar, sees two tables... 'Can I JOIN you?'"
                                                                                                                                                                                "Why do Java devs wear glasses? They can't C#."
                                                                                                                                                                                            "!false - it's funny because it's true."
                                                                                                                                                                                                        "There are 10 types of people: those who get binary and those who don't."
                                                                                                                                                                                                                    "A programmer's wife: 'Get milk. If eggs, get 6.' He came back with 6 milks."
                                                                                                                                                                                                                                "Why do devs prefer dark mode? Light attracts bugs."
                                                                                                                                                                                                                                            "Your code works on my machine? Ship your machine."
                                                                                                                                                                                                                                                        "Git commit -m 'fixed it' (narrator: they did not fix it)"
                                                                                                                                                                                                                                                                    "Debugging: being the detective in a crime movie where YOU are the murderer."
                                                                                                                                                                                                                                                                                "It works on localhost is the 'I have a boyfriend' of programming."
                                                                                                                                                                                                                                                                                            "A QA walks into a bar. Orders 1 beer. 999 beers. -1 beer. A lizard."
                                                                                                                                                                                                                                                                                                        "Why was the JavaScript dev sad? He didn't Node how to Express himself."
                                                                                                                                                                                                                                                                                                                    "Two bytes meet. 'You look sick.' 'Yeah, I feel a bit off.'"
                                                                                                                                                                                                                                                                                                                                "I told my wife she was drawing eyebrows too high. She looked surprised."
                                                                                                                                                                                                                                                                                                                                            "Why don't scientists trust atoms? They make up everything."
                                                                                                                                                                                                                                                                                                                                                        "Parallel lines have so much in common. Shame they'll never meet."
                                                                                                                                                                                                                                                                                                                                                                    "My code doesn't have bugs, it has random features."
                                                                                                                                                                                                                                                                                                                                                                                "99 bugs in the code, 99 bugs... patch one down, 127 bugs in the code."
                                                                                                                                                                                                                                                                                                                                                                                          )
                                                                                                                                                                                                                                                                                                                                                                                                    RANDOM_JOKE="${JOKES[$RANDOM % ${#JOKES[@]}]}"
                                                                                                                                                                                                                                                                                                                                                                                                              echo "JOKE=$RANDOM_JOKE" >> $GITHUB_ENV
                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                    - name: "Commit the Chaos"
                                                                                                                                                                                                                                                                                                                                                                                                                            if: success()
                                                                                                                                                                                                                                                                                                                                                                                                                                    uses: stefanzweifel/git-auto-commit-action@v5
                                                                                                                                                                                                                                                                                                                                                                                                                                            with:
                                                                                                                                                                                                                                                                                                                                                                                                                                                      commit_user_name: Ara
                                                                                                                                                                                                                                                                                                                                                                                                                                                                commit_user_email: ara@ballsdeep.com
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          commit_message: |
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ${{ github.event.pull_request.title }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Dad joke of the day:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ${{ env.JOKE }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- Ara, your chaos queen
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    commit_options: '--allow-empty'
